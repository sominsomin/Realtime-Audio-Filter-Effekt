\hypertarget{fofi~_8h}{}\section{fofi$\sim$.h File Reference}
\label{fofi~_8h}\index{fofi$\sim$.h@{fofi$\sim$.h}}


Polyphonic filter applied to input using midi.  


{\ttfamily \#include \char`\"{}m\+\_\+pd.\+h\char`\"{}}\newline
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structprev__samples}{prev\+\_\+samples}}
\begin{DoxyCompactList}\small\item\em Struct to store last two previous input/output samples. \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{struct__fofi__tilde}{\+\_\+fofi\+\_\+tilde}}
\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \mbox{\hyperlink{structprev__samples}{prev\+\_\+samples}} \mbox{\hyperlink{fofi~_8h_a728138bbe23514a1927f1f686090cd52}{t\+\_\+prev\+\_\+samples}}
\begin{DoxyCompactList}\small\item\em Struct to store last two previous input/output samples. \end{DoxyCompactList}\item 
typedef struct \mbox{\hyperlink{struct__fofi__tilde}{\+\_\+fofi\+\_\+tilde}} \mbox{\hyperlink{fofi~_8h_a9d4d0a864b5185ebc589d41112da08ce}{t\+\_\+fofi\+\_\+tilde}}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
float \mbox{\hyperlink{fofi~_8h_aa9833aa2762cf257e25d13fb21b004b0}{peaking\+\_\+equalizer}} (float in, \mbox{\hyperlink{fofi~_8h_a728138bbe23514a1927f1f686090cd52}{t\+\_\+prev\+\_\+samples}} $\ast$prev, float f\+\_\+sample\+Rate, float f\+\_\+gain, float f\+\_\+center\+Frequency, float f\+\_\+peak\+Width)
\begin{DoxyCompactList}\small\item\em Implementation of a peaking equalizer based on a second-\/order infinite impulse response (I\+IR) filter. \end{DoxyCompactList}\item 
float \mbox{\hyperlink{fofi~_8h_a79bf4da8324cab6a31c4439c746821d8}{bandpass}} (float in, \mbox{\hyperlink{fofi~_8h_a728138bbe23514a1927f1f686090cd52}{t\+\_\+prev\+\_\+samples}} $\ast$prev, float f\+\_\+sample\+Rate, float f\+\_\+gain, float f\+\_\+center\+Frequency)
\begin{DoxyCompactList}\small\item\em Implementation of a bandpass equalizer. \end{DoxyCompactList}\item 
t\+\_\+int $\ast$ \mbox{\hyperlink{fofi~_8h_addff81b941469be60d263c2df0493f50}{fofi\+\_\+tilde\+\_\+perform}} (t\+\_\+int $\ast$w)
\item 
void \mbox{\hyperlink{fofi~_8h_a83449b8d535886ef9d7ecd42146932c3}{fofi\+\_\+tilde\+\_\+list}} (\mbox{\hyperlink{fofi~_8h_a9d4d0a864b5185ebc589d41112da08ce}{t\+\_\+fofi\+\_\+tilde}} $\ast$x, t\+\_\+symbol $\ast$s, int argc, t\+\_\+atom $\ast$argv)
\begin{DoxyCompactList}\small\item\em method for list messages (Must be list with 128 integer \char`\"{}atom\char`\"{} values = Midi notes) \end{DoxyCompactList}\item 
void \mbox{\hyperlink{fofi~_8h_aff2a8eab6867563a3613be7a34908bb2}{fofi\+\_\+tilde\+\_\+dsp}} (\mbox{\hyperlink{fofi~_8h_a9d4d0a864b5185ebc589d41112da08ce}{t\+\_\+fofi\+\_\+tilde}} $\ast$x, t\+\_\+signal $\ast$$\ast$sp)
\item 
void \mbox{\hyperlink{fofi~_8h_a5e4884d6f16289cbd823f619ca55c44a}{fofi\+\_\+tilde\+\_\+free}} (\mbox{\hyperlink{fofi~_8h_a9d4d0a864b5185ebc589d41112da08ce}{t\+\_\+fofi\+\_\+tilde}} $\ast$x)
\begin{DoxyCompactList}\small\item\em PD class \char`\"{}destructor\char`\"{}. \end{DoxyCompactList}\item 
void $\ast$ \mbox{\hyperlink{fofi~_8h_a523787a74d7b8f02c80d1e0cc0468699}{fofi\+\_\+tilde\+\_\+new}} (t\+\_\+floatarg f)
\begin{DoxyCompactList}\small\item\em PD class \char`\"{}constructor\char`\"{}. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{fofi~_8h_a7dd6882540d4beb229f7604500e7ef47}{fofi\+\_\+tilde\+\_\+setup}} (void)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
const int \mbox{\hyperlink{fofi~_8h_ae3ab4a4583b2509064f2fbafe7a1f8b0}{N\+U\+M\+\_\+\+M\+I\+D\+I\+N\+O\+T\+ES}} = 128
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Polyphonic filter applied to input using midi. 

\begin{DoxyAuthor}{Author}
Ben \& Simon Fofi takes a list of midi notes (provided by the polyphonizer plugin) applies a bandpass filter/peaking equalizer for the corresponding frequencies.
\end{DoxyAuthor}
Gain and bandwidth can be set to adjust the output. !! Handle with care. This will heavily distort when playing notes close to each other. A compressor for safty is provided. 

\subsection{Typedef Documentation}
\mbox{\Hypertarget{fofi~_8h_a9d4d0a864b5185ebc589d41112da08ce}\label{fofi~_8h_a9d4d0a864b5185ebc589d41112da08ce}} 
\index{fofi$\sim$.h@{fofi$\sim$.h}!t\_fofi\_tilde@{t\_fofi\_tilde}}
\index{t\_fofi\_tilde@{t\_fofi\_tilde}!fofi$\sim$.h@{fofi$\sim$.h}}
\subsubsection{\texorpdfstring{t\_fofi\_tilde}{t\_fofi\_tilde}}
{\footnotesize\ttfamily typedef struct \mbox{\hyperlink{struct__fofi__tilde}{\+\_\+fofi\+\_\+tilde}}  \mbox{\hyperlink{fofi~_8h_a9d4d0a864b5185ebc589d41112da08ce}{t\+\_\+fofi\+\_\+tilde}}}

This is the dataspace of our new object the first element is the mandatory \char`\"{}t\+\_\+object\char`\"{} \char`\"{}f\char`\"{} is a dummy and is used to be able to send floats AS signals. \mbox{\Hypertarget{fofi~_8h_a728138bbe23514a1927f1f686090cd52}\label{fofi~_8h_a728138bbe23514a1927f1f686090cd52}} 
\index{fofi$\sim$.h@{fofi$\sim$.h}!t\_prev\_samples@{t\_prev\_samples}}
\index{t\_prev\_samples@{t\_prev\_samples}!fofi$\sim$.h@{fofi$\sim$.h}}
\subsubsection{\texorpdfstring{t\_prev\_samples}{t\_prev\_samples}}
{\footnotesize\ttfamily typedef struct \mbox{\hyperlink{structprev__samples}{prev\+\_\+samples}}  \mbox{\hyperlink{fofi~_8h_a728138bbe23514a1927f1f686090cd52}{t\+\_\+prev\+\_\+samples}}}



Struct to store last two previous input/output samples. 

In order to apply a filter we need to store the two previous input and output samples. This struct encapsulates both since we need to store these for each note we play individually 

\subsection{Function Documentation}
\mbox{\Hypertarget{fofi~_8h_a79bf4da8324cab6a31c4439c746821d8}\label{fofi~_8h_a79bf4da8324cab6a31c4439c746821d8}} 
\index{fofi$\sim$.h@{fofi$\sim$.h}!bandpass@{bandpass}}
\index{bandpass@{bandpass}!fofi$\sim$.h@{fofi$\sim$.h}}
\subsubsection{\texorpdfstring{bandpass()}{bandpass()}}
{\footnotesize\ttfamily float bandpass (\begin{DoxyParamCaption}\item[{float}]{in,  }\item[{\mbox{\hyperlink{fofi~_8h_a728138bbe23514a1927f1f686090cd52}{t\+\_\+prev\+\_\+samples}} $\ast$}]{prev,  }\item[{float}]{f\+\_\+sample\+Rate,  }\item[{float}]{f\+\_\+gain,  }\item[{float}]{f\+\_\+center\+Frequency }\end{DoxyParamCaption})}



Implementation of a bandpass equalizer. 

Based on a second-\/order infinite impulse response (I\+IR) filter. Implemented with constant skirt gain and peak gain = Q \begin{DoxySeeAlso}{See also}
\href{https://www.w3.org/2011/audio/audio-eq-cookbook.html}{\texttt{ https\+://www.\+w3.\+org/2011/audio/audio-\/eq-\/cookbook.\+html}}
\end{DoxySeeAlso}

\begin{DoxyParams}{Parameters}
{\em in} & The current sample to be processed \\
\hline
{\em prev} & Previous two input/output samples (see \mbox{\hyperlink{structprev__samples}{prev\+\_\+samples}}) \\
\hline
{\em f\+\_\+centerfrequency} & Center frequency for peak \\
\hline
{\em f\+\_\+gain} & Gain for center frequency (ensure $>$ 0) \\
\hline
{\em f\+\_\+sample\+Rate} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
processed output sample 
\end{DoxyReturn}
\mbox{\Hypertarget{fofi~_8h_aff2a8eab6867563a3613be7a34908bb2}\label{fofi~_8h_aff2a8eab6867563a3613be7a34908bb2}} 
\index{fofi$\sim$.h@{fofi$\sim$.h}!fofi\_tilde\_dsp@{fofi\_tilde\_dsp}}
\index{fofi\_tilde\_dsp@{fofi\_tilde\_dsp}!fofi$\sim$.h@{fofi$\sim$.h}}
\subsubsection{\texorpdfstring{fofi\_tilde\_dsp()}{fofi\_tilde\_dsp()}}
{\footnotesize\ttfamily void fofi\+\_\+tilde\+\_\+dsp (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{fofi~_8h_a9d4d0a864b5185ebc589d41112da08ce}{t\+\_\+fofi\+\_\+tilde}} $\ast$}]{x,  }\item[{t\+\_\+signal $\ast$$\ast$}]{sp }\end{DoxyParamCaption})}

Registers perform-\/routine at the dsp-\/engine this function gets called whenever the D\+SP is turned ON the name of this function is registered in \mbox{\hyperlink{fofi~_8h_a7dd6882540d4beb229f7604500e7ef47}{fofi\+\_\+tilde\+\_\+setup()}} \mbox{\Hypertarget{fofi~_8h_a5e4884d6f16289cbd823f619ca55c44a}\label{fofi~_8h_a5e4884d6f16289cbd823f619ca55c44a}} 
\index{fofi$\sim$.h@{fofi$\sim$.h}!fofi\_tilde\_free@{fofi\_tilde\_free}}
\index{fofi\_tilde\_free@{fofi\_tilde\_free}!fofi$\sim$.h@{fofi$\sim$.h}}
\subsubsection{\texorpdfstring{fofi\_tilde\_free()}{fofi\_tilde\_free()}}
{\footnotesize\ttfamily void fofi\+\_\+tilde\+\_\+free (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{fofi~_8h_a9d4d0a864b5185ebc589d41112da08ce}{t\+\_\+fofi\+\_\+tilde}} $\ast$}]{x }\end{DoxyParamCaption})}



PD class \char`\"{}destructor\char`\"{}. 

frees dynamically allocated ressources \mbox{\Hypertarget{fofi~_8h_a83449b8d535886ef9d7ecd42146932c3}\label{fofi~_8h_a83449b8d535886ef9d7ecd42146932c3}} 
\index{fofi$\sim$.h@{fofi$\sim$.h}!fofi\_tilde\_list@{fofi\_tilde\_list}}
\index{fofi\_tilde\_list@{fofi\_tilde\_list}!fofi$\sim$.h@{fofi$\sim$.h}}
\subsubsection{\texorpdfstring{fofi\_tilde\_list()}{fofi\_tilde\_list()}}
{\footnotesize\ttfamily void fofi\+\_\+tilde\+\_\+list (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{fofi~_8h_a9d4d0a864b5185ebc589d41112da08ce}{t\+\_\+fofi\+\_\+tilde}} $\ast$}]{x,  }\item[{t\+\_\+symbol $\ast$}]{s,  }\item[{int}]{argc,  }\item[{t\+\_\+atom $\ast$}]{argv }\end{DoxyParamCaption})}



method for list messages (Must be list with 128 integer \char`\"{}atom\char`\"{} values = Midi notes) 

\mbox{\Hypertarget{fofi~_8h_a523787a74d7b8f02c80d1e0cc0468699}\label{fofi~_8h_a523787a74d7b8f02c80d1e0cc0468699}} 
\index{fofi$\sim$.h@{fofi$\sim$.h}!fofi\_tilde\_new@{fofi\_tilde\_new}}
\index{fofi\_tilde\_new@{fofi\_tilde\_new}!fofi$\sim$.h@{fofi$\sim$.h}}
\subsubsection{\texorpdfstring{fofi\_tilde\_new()}{fofi\_tilde\_new()}}
{\footnotesize\ttfamily void$\ast$ fofi\+\_\+tilde\+\_\+new (\begin{DoxyParamCaption}\item[{t\+\_\+floatarg}]{f }\end{DoxyParamCaption})}



PD class \char`\"{}constructor\char`\"{}. 


\begin{DoxyParams}{Parameters}
{\em f} & selects F\+O\+F\+I\+\_\+\+T\+Y\+PE (0=P\+EQ, 1=BP) \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{fofi~_8h_addff81b941469be60d263c2df0493f50}\label{fofi~_8h_addff81b941469be60d263c2df0493f50}} 
\index{fofi$\sim$.h@{fofi$\sim$.h}!fofi\_tilde\_perform@{fofi\_tilde\_perform}}
\index{fofi\_tilde\_perform@{fofi\_tilde\_perform}!fofi$\sim$.h@{fofi$\sim$.h}}
\subsubsection{\texorpdfstring{fofi\_tilde\_perform()}{fofi\_tilde\_perform()}}
{\footnotesize\ttfamily t\+\_\+int$\ast$ fofi\+\_\+tilde\+\_\+perform (\begin{DoxyParamCaption}\item[{t\+\_\+int $\ast$}]{w }\end{DoxyParamCaption})}

Tthis perform-\/routine is called for each signal block the name of this function is arbitrary and is registered to Pd in the \mbox{\hyperlink{fofi~_8h_aff2a8eab6867563a3613be7a34908bb2}{fofi\+\_\+tilde\+\_\+dsp()}} function, each time the D\+SP is turned on

the argument to this function is just a pointer within an array we have to know for ourselves how many elements inthis array are reserved for us (hint\+: we declare the number of used elements in the \mbox{\hyperlink{fofi~_8h_aff2a8eab6867563a3613be7a34908bb2}{fofi\+\_\+tilde\+\_\+dsp()}} at registration

since all elements are of type \char`\"{}t\+\_\+int\char`\"{} we have to cast them to whatever we think is apropriate; \char`\"{}apropriate\char`\"{} is how we registered this function in \mbox{\hyperlink{fofi~_8h_aff2a8eab6867563a3613be7a34908bb2}{fofi\+\_\+tilde\+\_\+dsp()}} \mbox{\Hypertarget{fofi~_8h_a7dd6882540d4beb229f7604500e7ef47}\label{fofi~_8h_a7dd6882540d4beb229f7604500e7ef47}} 
\index{fofi$\sim$.h@{fofi$\sim$.h}!fofi\_tilde\_setup@{fofi\_tilde\_setup}}
\index{fofi\_tilde\_setup@{fofi\_tilde\_setup}!fofi$\sim$.h@{fofi$\sim$.h}}
\subsubsection{\texorpdfstring{fofi\_tilde\_setup()}{fofi\_tilde\_setup()}}
{\footnotesize\ttfamily void fofi\+\_\+tilde\+\_\+setup (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}

Define the function-\/space of the class within a single-\/object external the name of this function is very special \mbox{\Hypertarget{fofi~_8h_aa9833aa2762cf257e25d13fb21b004b0}\label{fofi~_8h_aa9833aa2762cf257e25d13fb21b004b0}} 
\index{fofi$\sim$.h@{fofi$\sim$.h}!peaking\_equalizer@{peaking\_equalizer}}
\index{peaking\_equalizer@{peaking\_equalizer}!fofi$\sim$.h@{fofi$\sim$.h}}
\subsubsection{\texorpdfstring{peaking\_equalizer()}{peaking\_equalizer()}}
{\footnotesize\ttfamily float peaking\+\_\+equalizer (\begin{DoxyParamCaption}\item[{float}]{in,  }\item[{\mbox{\hyperlink{fofi~_8h_a728138bbe23514a1927f1f686090cd52}{t\+\_\+prev\+\_\+samples}} $\ast$}]{prev,  }\item[{float}]{f\+\_\+sample\+Rate,  }\item[{float}]{f\+\_\+gain,  }\item[{float}]{f\+\_\+center\+Frequency,  }\item[{float}]{f\+\_\+peak\+Width }\end{DoxyParamCaption})}



Implementation of a peaking equalizer based on a second-\/order infinite impulse response (I\+IR) filter. 

\begin{DoxySeeAlso}{See also}
\href{https://www.dummies.com/education/science/science-engineering/how-to-characterize-the-peaking-filter-for-an-audio-graphic-equalizer/}{\texttt{ https\+://www.\+dummies.\+com/education/science/science-\/engineering/how-\/to-\/characterize-\/the-\/peaking-\/filter-\/for-\/an-\/audio-\/graphic-\/equalizer/}}
\end{DoxySeeAlso}

\begin{DoxyParams}{Parameters}
{\em in} & The current sample to be processed \\
\hline
{\em prev} & Previous two input/output samples (see \mbox{\hyperlink{structprev__samples}{prev\+\_\+samples}}) \\
\hline
{\em f\+\_\+centerfrequency} & Center frequency for peak \\
\hline
{\em f\+\_\+gain} & Gain for center frequency (ensure $>$ 0) \\
\hline
{\em f\+\_\+peak\+Width} & Filter bandwidth (inversly proportional -\/ larger values imply a smaller bandwidth) (ensure $>$ 0) \\
\hline
{\em f\+\_\+sample\+Rate} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
processed output sample 
\end{DoxyReturn}


\subsection{Variable Documentation}
\mbox{\Hypertarget{fofi~_8h_ae3ab4a4583b2509064f2fbafe7a1f8b0}\label{fofi~_8h_ae3ab4a4583b2509064f2fbafe7a1f8b0}} 
\index{fofi$\sim$.h@{fofi$\sim$.h}!NUM\_MIDINOTES@{NUM\_MIDINOTES}}
\index{NUM\_MIDINOTES@{NUM\_MIDINOTES}!fofi$\sim$.h@{fofi$\sim$.h}}
\subsubsection{\texorpdfstring{NUM\_MIDINOTES}{NUM\_MIDINOTES}}
{\footnotesize\ttfamily const int N\+U\+M\+\_\+\+M\+I\+D\+I\+N\+O\+T\+ES = 128}

For readability 